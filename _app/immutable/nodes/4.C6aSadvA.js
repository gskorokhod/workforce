import{s as ue,w as M,e as Y,a as j,c as Z,b as x,g as z,f as v,m as U,i as B,h as X,x as S,B as ee,q as ce,u as de,r as me,v as _e,n as pe,C as Ce}from"../chunks/scheduler.DpdggcV9.js";import{S as ge,i as he,e as y,c as k,a as I,m as F,t as _,g as te,b as p,f as se,d as D}from"../chunks/index.KweK3yxl.js";import{E as ke,D as Ie,M as Fe,S as De,h as Ve,i as ve}from"../chunks/delete-dialog.B_NFlwz3.js";import{B as Ee,s as be,L as ae}from"../chunks/stores.CiPEPIsB.js";import{w as Ke}from"../chunks/index.DKR0vYLz.js";import{D as Le,c as ne,T as Pe,a as Me}from"../chunks/table-header.BNCtrxSs.js";import{P as Se}from"../chunks/property-value.D63xMnEZ.js";import{m as le}from"../chunks/index.Dv-tIgqn.js";import{C as ye}from"../chunks/column-hide-selector.C-7mzX7I.js";const Ae=s=>({}),oe=s=>({}),Ne=s=>({}),ie=s=>({});function re(s){let e,a;return e=new Fe({props:{locations:s[13],class:"aspect-auto "+s[3],onMarkerClick:s[16]}}),{c(){k(e.$$.fragment)},l(t){I(e.$$.fragment,t)},m(t,l){F(e,t,l),a=!0},p(t,l){const i={};l&8192&&(i.locations=t[13]),l&8&&(i.class="aspect-auto "+t[3]),e.$set(i)},i(t){a||(_(e.$$.fragment,t),a=!0)},o(t){p(e.$$.fragment,t),a=!1},d(t){D(e,t)}}}function fe(s){let e,a;return e=new Pe({props:{sticky:!0,$$slots:{end:[Be],middle:[ze],start:[je]},$$scope:{ctx:s}}}),{c(){k(e.$$.fragment)},l(t){I(e.$$.fragment,t)},m(t,l){F(e,t,l),a=!0},p(t,l){const i={};l&268435872&&(i.$$scope={dirty:l,ctx:t}),e.$set(i)},i(t){a||(_(e.$$.fragment,t),a=!0)},o(t){p(e.$$.fragment,t),a=!1},d(t){D(e,t)}}}function Te(s){let e,a;return e=new ve({}),{c(){k(e.$$.fragment)},l(t){I(e.$$.fragment,t)},m(t,l){F(e,t,l),a=!0},i(t){a||(_(e.$$.fragment,t),a=!0)},o(t){p(e.$$.fragment,t),a=!1},d(t){D(e,t)}}}function je(s){let e,a,t;e=new Ee({props:{class:"text-muted-foreground hover:text-accent-foreground",size:"icon-xl",variant:"ghost",$$slots:{default:[Te]},$$scope:{ctx:s}}}),e.$on("click",s[17]);const l=s[19].start,i=ce(l,s,s[28],oe);return{c(){k(e.$$.fragment),a=j(),i&&i.c()},l(f){I(e.$$.fragment,f),a=z(f),i&&i.l(f)},m(f,m){F(e,f,m),B(f,a,m),i&&i.m(f,m),t=!0},p(f,m){const r={};m&268435456&&(r.$$scope={dirty:m,ctx:f}),e.$set(r),i&&i.p&&(!t||m&268435456)&&de(i,l,f,f[28],t?_e(l,f[28],m,Ae):me(f[28]),oe)},i(f){t||(_(e.$$.fragment,f),_(i,f),t=!0)},o(f){p(e.$$.fragment,f),p(i,f),t=!1},d(f){f&&v(a),D(e,f),i&&i.d(f)}}}function ze(s){let e;const a=s[19].middle,t=ce(a,s,s[28],ie);return{c(){t&&t.c()},l(l){t&&t.l(l)},m(l,i){t&&t.m(l,i),e=!0},p(l,i){t&&t.p&&(!e||i&268435456)&&de(t,a,l,l[28],e?_e(a,l[28],i,Ne):me(l[28]),ie)},i(l){e||(_(t,l),e=!0)},o(l){p(t,l),e=!1},d(l){t&&t.d(l)}}}function Be(s){let e,a,t,l,i;function f(r){s[20](r)}let m={flatColumns:s[8]};return s[7]!==void 0&&(m.hideForId=s[7]),e=new ye({props:m}),M.push(()=>y(e,"hideForId",f)),l=new De({props:{onInput:s[21]}}),{c(){k(e.$$.fragment),t=j(),k(l.$$.fragment)},l(r){I(e.$$.fragment,r),t=z(r),I(l.$$.fragment,r)},m(r,h){F(e,r,h),B(r,t,h),F(l,r,h),i=!0},p(r,h){const b={};h&256&&(b.flatColumns=r[8]),!a&&h&128&&(a=!0,b.hideForId=r[7],S(()=>a=!1)),e.$set(b);const V={};h&32&&(V.onInput=r[21]),l.$set(V)},i(r){i||(_(e.$$.fragment,r),_(l.$$.fragment,r),i=!0)},o(r){p(e.$$.fragment,r),p(l.$$.fragment,r),i=!1},d(r){r&&v(t),D(e,r),D(l,r)}}}function qe(s){let e,a,t,l,i,f,m,r,h,b,V,$,K,C,w,A,E,c=s[1]&&re(s),d=s[1]&&fe(s);function L(o){s[22](o)}function q(o){s[23](o)}function G(o){s[24](o)}function H(o){s[25](o)}let P={class:"w-full",columnInitializers:s[14],data:s[0],actions:s[4],header:s[1],defaultAction:s[15]};s[5]!==void 0&&(P.filterValue=s[5]),s[8]!==void 0&&(P.flatColumns=s[8]),s[7]!==void 0&&(P.hideForId=s[7]),s[6]!==void 0&&(P.sortKeys=s[6]),i=new Le({props:P}),M.push(()=>y(i,"filterValue",L)),M.push(()=>y(i,"flatColumns",q)),M.push(()=>y(i,"hideForId",G)),M.push(()=>y(i,"sortKeys",H));function O(o){s[26](o)}let J={selected:s[9],title:s[12]};s[11]!==void 0&&(J.open=s[11]),$=new ke({props:J}),M.push(()=>y($,"open",O));function W(o){s[27](o)}let Q={selected:s[9]};return s[10]!==void 0&&(Q.open=s[10]),w=new Ie({props:Q}),M.push(()=>y(w,"open",W)),{c(){e=Y("div"),c&&c.c(),a=j(),t=Y("div"),d&&d.c(),l=j(),k(i.$$.fragment),V=j(),k($.$$.fragment),C=j(),k(w.$$.fragment),this.h()},l(o){e=Z(o,"DIV",{class:!0});var u=x(e);c&&c.l(u),a=z(u),t=Z(u,"DIV",{class:!0});var g=x(t);d&&d.l(g),l=z(g),I(i.$$.fragment,g),g.forEach(v),u.forEach(v),V=z(o),I($.$$.fragment,o),C=z(o),I(w.$$.fragment,o),this.h()},h(){U(t,"class","mt-4 flex h-max w-full flex-col items-start justify-start overflow-y-scroll"),U(e,"class",b="flex flex-col items-start justify-start "+s[2])},m(o,u){B(o,e,u),c&&c.m(e,null),X(e,a),X(e,t),d&&d.m(t,null),X(t,l),F(i,t,null),B(o,V,u),F($,o,u),B(o,C,u),F(w,o,u),E=!0},p(o,[u]){o[1]?c?(c.p(o,u),u&2&&_(c,1)):(c=re(o),c.c(),_(c,1),c.m(e,a)):c&&(te(),p(c,1,1,()=>{c=null}),se()),o[1]?d?(d.p(o,u),u&2&&_(d,1)):(d=fe(o),d.c(),_(d,1),d.m(t,l)):d&&(te(),p(d,1,1,()=>{d=null}),se());const g={};u&1&&(g.data=o[0]),u&16&&(g.actions=o[4]),u&2&&(g.header=o[1]),!f&&u&32&&(f=!0,g.filterValue=o[5],S(()=>f=!1)),!m&&u&256&&(m=!0,g.flatColumns=o[8],S(()=>m=!1)),!r&&u&128&&(r=!0,g.hideForId=o[7],S(()=>r=!1)),!h&&u&64&&(h=!0,g.sortKeys=o[6],S(()=>h=!1)),i.$set(g),(!E||u&4&&b!==(b="flex flex-col items-start justify-start "+o[2]))&&U(e,"class",b);const N={};u&512&&(N.selected=o[9]),u&4096&&(N.title=o[12]),!K&&u&2048&&(K=!0,N.open=o[11],S(()=>K=!1)),$.$set(N);const R={};u&512&&(R.selected=o[9]),!A&&u&1024&&(A=!0,R.open=o[10],S(()=>A=!1)),w.$set(R)},i(o){E||(_(c),_(d),_(i.$$.fragment,o),_($.$$.fragment,o),_(w.$$.fragment,o),E=!0)},o(o){p(c),p(d),p(i.$$.fragment,o),p($.$$.fragment,o),p(w.$$.fragment,o),E=!1},d(o){o&&(v(e),v(V),v(C)),c&&c.d(),d&&d.d(),D(i),D($,o),D(w,o)}}}function Oe(s,e,a){let t,l=pe,i=()=>(l(),l=Ce(r,n=>a(13,t=n)),r);s.$$.on_destroy.push(()=>l());let{$$slots:f={},$$scope:m}=e,{data:r}=e;i();let{header:h=!0}=e,{state:b=be}=e,V=new Map,$=Ke(""),K=Me([]),C={},w,{class:A=""}=e,{mapClass:E="h-[300px] w-full"}=e,c,d=!1,L=!1,q="Edit Location",G=[{accessor:n=>n,cell:n=>ne(Ve,{item:n.value}),header:"Picture",id:"picture",plugins:{sort:{disable:!0},tableFilter:{disable:!0}}},{accessor:n=>n.name,header:"Name",id:"name"},{accessor:n=>{var T;return((T=n.point)==null?void 0:T.address.format(["street","settlement","country","postcode"]))||"No Address"},header:"Address",id:"address"},{accessor:n=>le(n.min.people,n.max.people,"people"),header:"Capacity (People)",id:"capacity_people"},{accessor:n=>le(n.min.tasks,n.max.tasks,"tasks"),header:"Capacity (Tasks)",id:"capacity_tasks"}];for(const n of ee(b.templates).location.keys)G.push({accessor:T=>T.properties.get(n),cell:T=>ne(Se,{property:n,value:T.value}),header:n.name,id:n.uuid});let{actions:H=new Map([...V,["Edit",O],["Delete",P]])}=e;function P(n){ee(b.settings).askDeleteConfirmation?(a(9,c=n),a(10,d=!0)):n.delete()}function O(n){a(12,q="Edit Location"),a(9,c=n.pull()),a(11,L=!0)}function J(n){n instanceof ae&&O(n)}function W(){a(12,q="Create new Location"),a(9,c=new ae({name:""},b)),a(11,L=!0)}function Q(n){C=n,a(7,C)}const o=n=>$.set(n);function u(n){$=n,a(5,$)}function g(n){w=n,a(8,w)}function N(n){C=n,a(7,C)}function R(n){K=n,a(6,K)}function $e(n){L=n,a(11,L)}function we(n){d=n,a(10,d)}return s.$$set=n=>{"data"in n&&i(a(0,r=n.data)),"header"in n&&a(1,h=n.header),"state"in n&&a(18,b=n.state),"class"in n&&a(2,A=n.class),"mapClass"in n&&a(3,E=n.mapClass),"actions"in n&&a(4,H=n.actions),"$$scope"in n&&a(28,m=n.$$scope)},[r,h,A,E,H,$,K,C,w,c,d,L,q,t,G,O,J,W,b,f,Q,o,u,g,N,R,$e,we,m]}class Re extends ge{constructor(e){super(),he(this,e,Oe,qe,ue,{data:0,header:1,state:18,class:2,mapClass:3,actions:4})}}function Ge(s){let e,a,t;return a=new Re({props:{data:s[0],class:"h-full w-full rounded-md border shadow-md",mapClass:"w-full h-[40vh]"}}),{c(){e=Y("main"),k(a.$$.fragment),this.h()},l(l){e=Z(l,"MAIN",{class:!0});var i=x(e);I(a.$$.fragment,i),i.forEach(v),this.h()},h(){U(e,"class","h-full w-full")},m(l,i){B(l,e,i),F(a,e,null),t=!0},p:pe,i(l){t||(_(a.$$.fragment,l),t=!0)},o(l){p(a.$$.fragment,l),t=!1},d(l){l&&v(e),D(a)}}}function He(s){return[be.locations]}class tt extends ge{constructor(e){super(),he(this,e,He,Ge,ue,{})}}export{tt as component};
